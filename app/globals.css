@import "tailwindcss";
@import "tw-animate-css";
@import "shadcn/tailwind.css";
@source "../packages/ui/src";

@custom-variant dark (&:is(.dark *));

/* ============================================================================
   APPLE DESIGN SYSTEM INTEGRATION
   Follows macOS/iOS Human Interface Guidelines
   - System colors (no custom gradients)
   - SF Pro typography (system font)
   - 8pt grid spacing
   - Standard 12px border radius
   ============================================================================ */

@theme inline {
  /* Color mappings (use system colors) */
  --color-background: var(--system-background);
  --color-foreground: var(--system-label);

  /* Typography (SF Pro system font) */
  --font-sans: -apple-system, BlinkMacSystemFont, "SF Pro", system-ui, sans-serif;
  --font-mono: ui-monospace, "SF Mono", Menlo, Monaco, monospace;

  /* Legacy shadcn mappings (maintain compatibility) */
  --color-card: var(--system-secondary-background);
  --color-card-foreground: var(--system-label);
  --color-popover: var(--system-secondary-background);
  --color-popover-foreground: var(--system-label);
  --color-primary: var(--system-blue);
  --color-primary-foreground: oklch(0.95 0 0);
  --color-secondary: var(--system-secondary-background);
  --color-secondary-foreground: var(--system-label);
  --color-muted: var(--system-tertiary-background);
  --color-muted-foreground: var(--system-secondary-label);
  --color-accent: var(--system-tertiary-background);
  --color-accent-foreground: var(--system-label);
  --color-destructive: var(--system-red);
  --color-border: var(--system-separator);
  --color-input: var(--system-separator);
  --color-ring: var(--system-blue);

  /* Chart colors (system palette) */
  --color-chart-1: var(--system-blue);
  --color-chart-2: var(--system-green);
  --color-chart-3: var(--system-orange);
  --color-chart-4: var(--system-purple);
  --color-chart-5: var(--system-pink);

  /* Border radius (12px standard) */
  --radius-sm: 6px;
  --radius-md: 10px;
  --radius-lg: 12px;   /* Standard macOS/iOS */
  --radius-xl: 16px;
  --radius-2xl: 20px;
  --radius-3xl: 24px;
  --radius-4xl: 28px;
}

/* ============================================================================
   APPLE SYSTEM COLORS (Dark Mode Only)
   Based on macOS/iOS system palette
   ============================================================================ */

:root,
.dark {
  /* Text colors */
  --system-label: oklch(0.95 0 0);                    /* Primary text */
  --system-secondary-label: oklch(0.70 0 0);          /* Secondary text */
  --system-tertiary-label: oklch(0.55 0 0);           /* Tertiary text */
  --system-quaternary-label: oklch(0.40 0 0);         /* Disabled text */

  /* Background colors */
  --system-background: oklch(0.07 0 0);               /* App background */
  --system-secondary-background: oklch(0.12 0 0);     /* Cards, modals */
  --system-tertiary-background: oklch(0.18 0 0);      /* Elevated surfaces */

  /* Grouped backgrounds (lists, tables) */
  --system-grouped-background: oklch(0.07 0 0);
  --system-secondary-grouped-background: oklch(0.12 0 0);
  --system-tertiary-grouped-background: oklch(0.18 0 0);

  /* Separators */
  --system-separator: oklch(1 0 0 / 10%);            /* Dividers */
  --system-opaque-separator: oklch(0.25 0 0);        /* Opaque dividers */

  /* Link color */
  --system-link: oklch(0.65 0.20 240);               /* Hyperlinks */

  /* Semantic colors (Apple system palette) */
  --system-red: oklch(0.65 0.24 27);
  --system-orange: oklch(0.70 0.19 70);
  --system-yellow: oklch(0.77 0.19 85);
  --system-green: oklch(0.70 0.17 162);
  --system-mint: oklch(0.72 0.14 180);
  --system-teal: oklch(0.68 0.15 200);
  --system-cyan: oklch(0.70 0.16 215);
  --system-blue: oklch(0.60 0.20 250);
  --system-indigo: oklch(0.55 0.22 270);
  --system-purple: oklch(0.62 0.27 304);
  --system-pink: oklch(0.68 0.25 10);
  --system-brown: oklch(0.58 0.12 60);
  --system-gray: oklch(0.55 0 0);

  /* Legacy variables (for compatibility) */
  --radius: 12px;  /* Standard macOS/iOS */
  --background: var(--system-background);
  --foreground: var(--system-label);
  --card: var(--system-secondary-background);
  --card-foreground: var(--system-label);
  --popover: var(--system-secondary-background);
  --popover-foreground: var(--system-label);
  --primary: var(--system-blue);
  --primary-foreground: oklch(0.95 0 0);
  --secondary: var(--system-secondary-background);
  --secondary-foreground: var(--system-label);
  --muted: var(--system-tertiary-background);
  --muted-foreground: var(--system-secondary-label);
  --accent: var(--system-tertiary-background);
  --accent-foreground: var(--system-label);
  --destructive: var(--system-red);
  --border: var(--system-separator);
  --input: var(--system-separator);
  --ring: var(--system-blue);
  --chart-1: var(--system-blue);
  --chart-2: var(--system-green);
  --chart-3: var(--system-orange);
  --chart-4: var(--system-purple);
  --chart-5: var(--system-pink);
}

/* ============================================================================
   BASE STYLES
   ============================================================================ */

@layer base {
  * {
    @apply border-border outline-ring/50;
  }

  html, body {
    height: 100%;
    overflow: hidden;
  }

  body {
    @apply bg-background text-foreground;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro", system-ui, sans-serif;
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
    user-select: none;
    overscroll-behavior: none;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
}

/* ============================================================================
   INPUT CLEANUP
   ============================================================================ */

/* Remove number input spinners */
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type="number"] {
  -moz-appearance: textfield;
}

/* ============================================================================
   ANIMATIONS (Apple Standard Motion)
   Duration: 300ms (standard), Easing: cubic-bezier(0.4, 0.0, 0.2, 1)
   Respects prefers-reduced-motion
   ============================================================================ */

@keyframes countdown-pulse {
  0% {
    transform: scale(1.3);
    opacity: 0.7;
  }
  50% {
    transform: scale(1);
    opacity: 1;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes tap-bounce {
  0% { transform: scale(0.92); }
  50% { transform: scale(1.02); }
  100% { transform: scale(1); }
}

@keyframes dot-pop {
  0% { transform: scale(1); }
  50% { transform: scale(1.6); box-shadow: 0 0 8px currentColor; }
  100% { transform: scale(1); }
}

@keyframes feedback-pop {
  0% { transform: scale(0.5); opacity: 0; }
  30% { transform: scale(1.1); opacity: 0.8; }
  100% { transform: scale(1.4); opacity: 0; }
}

@keyframes slide-down-in {
  from { transform: translateY(-20px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes slide-up-in {
  from { transform: translateY(20px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes bounce-in {
  0% { transform: scale(0); opacity: 0; }
  60% { transform: scale(1.15); opacity: 1; }
  80% { transform: scale(0.95); }
  100% { transform: scale(1); }
}

@keyframes stagger-in {
  from { transform: translateY(12px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

/* Respect reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
